(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["RedCreate"],{"1e4c":function(e,t,n){e.exports=n.p+"static/img/tokenpocket.f7c173ee.png"},2056:function(e,t,n){"use strict";n.r(t);n("ac1f"),n("841c"),n("99af"),n("b0c0");var o=n("7a23"),r={class:"create-container"},c={class:"currency"},a={class:"content"},i={class:"fl flex"},l=Object(o["createTextVNode"])("  "),s={class:"flex-end"},u=Object(o["createTextVNode"])("   "),d={class:"flex-start"},m={class:"icon"},b={class:"ml-4"},f={class:"flex-end"},p={class:"color_333"},h={class:"block mt_5 ml_15 color_999999"},j={class:"flex-start"},O={class:"ml-4"},g={class:"flex-end"},k={class:"color_333"},v={class:"block mt_5 color_999999 ml_15"},w={class:"flex-start"},x={class:"ml-4"},y={class:"flex-end"},$={class:"color_999999 mt_20 block text-center"},N={class:"color_333 font_24"},V={class:"mt_5 flex"},C={key:0,class:"width-100"},_={class:"tip"},A={class:"jump text-center"},S={class:"padding_l15_r15"},E={class:"font_16 color-000",style:{display:"grid"}},D={class:"font-12 color-F6465D block mt_20"},B={class:"fl flex"},T=Object(o["createTextVNode"])("  "),R={class:"ml-10"},U={class:"bottom padding_l15_r15 text-center"},I={class:"flex"};function L(e,t,L,q,F,P){var z=Object(o["resolveComponent"])("van-nav-bar"),W=Object(o["resolveComponent"])("van-radio"),M=Object(o["resolveComponent"])("van-radio-group"),J=Object(o["resolveComponent"])("van-field"),G=Object(o["resolveComponent"])("van-cell"),K=Object(o["resolveComponent"])("van-search"),H=Object(o["resolveComponent"])("van-image"),Q=Object(o["resolveComponent"])("van-cell-group"),Y=Object(o["resolveComponent"])("van-empty"),X=Object(o["resolveComponent"])("van-action-sheet"),Z=Object(o["resolveComponent"])("van-picker"),ee=Object(o["resolveComponent"])("van-popup"),te=Object(o["resolveComponent"])("van-button"),ne=Object(o["resolveComponent"])("van-form"),oe=Object(o["resolveComponent"])("van-icon"),re=Object(o["resolveComponent"])("van-checkbox"),ce=Object(o["resolveComponent"])("van-overlay");return Object(o["openBlock"])(),Object(o["createElementBlock"])("section",r,[Object(o["createVNode"])(z,{"left-text":"","left-arrow":"",onClickLeft:t[0]||(t[0]=function(t){return e.$f.goBack()}),fixed:"",placeholder:"","safe-area-inset-top":"","z-index":"2",title:e.$t("createRedPacket")},null,8,["title"]),Object(o["createVNode"])(ne,{class:"form",onSubmit:P.onSubmit},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(J,{name:"radio",class:"mt_20 bg_transparent padding_0"},{input:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(M,{modelValue:F.form.type,"onUpdate:modelValue":t[1]||(t[1]=function(e){return F.form.type=e}),direction:"horizontal"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(W,{name:"0","checked-color":"#ED4A4A"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("randomRedPacket")),1)]})),_:1}),Object(o["createVNode"])(W,{name:"1","checked-color":"#ED4A4A"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("identicalRedPacket")),1)]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),Object(o["createVNode"])(G,{class:"mt_20 flex",border:!1},{title:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(e.$t("token")),1)]})),value:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",c,[Object(o["createVNode"])(G,{"is-link":"",border:!1,title:F.currencyObj.symbol,onClick:t[2]||(t[2]=function(e){return F.show=!0}),style:{"padding-right":"0"}},null,8,["title"]),Object(o["createVNode"])(X,{show:F.show,"onUpdate:show":t[5]||(t[5]=function(e){return F.show=e}),title:e.$t("selectToken")},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",a,[Object(o["createVNode"])(K,{modelValue:F.search,"onUpdate:modelValue":[t[3]||(t[3]=function(e){return F.search=e}),P.onSearch],clearable:"",placeholder:e.$t("searchNameOrAddress")},null,8,["modelValue","placeholder","onUpdate:modelValue"]),F.resultList.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(M,{key:0,modelValue:F.tokenAddress,"onUpdate:modelValue":t[4]||(t[4]=function(e){return F.tokenAddress=e})},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(Q,{inset:"",class:"",style:{overflow:"auto","max-height":"200px"}},{default:Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(F.resultList,(function(t,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:r},[Object(o["createVNode"])(G,{clickable:"",onClick:function(e){F.tokenAddress=t.id,F.currencyObj=t,F.show=!1}},{title:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",i,[Object(o["createVNode"])(H,{round:"",width:"0.4rem",height:"0.4rem","icon-size":"0.4rem","lazy-load":"","show-loading":"",class:"icon-left",src:e.$f.formatIcon("".concat(t.id,"-").concat(t.chain)),"error-icon":n("aecc")},null,8,["src","error-icon"]),l,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.symbol),1)])]})),value:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(e.$t("balance"))+": "+Object(o["toDisplayString"])(e.$f.formatNumUnit(t.amount)),1),u])]})),_:2},1032,["onClick"])])})),128))]})),_:1})]})),_:1},8,["modelValue"])):(Object(o["openBlock"])(),Object(o["createBlock"])(Y,{key:1,description:e.$t("emptyData")},null,8,["description"]))])]})),_:1},8,["show","title"])])]})),_:1}),Object(o["createVNode"])(G,{class:"mt_20 flex"},{title:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",d,[Object(o["createElementVNode"])("span",m,Object(o["toDisplayString"])("1"==F.form.type?e.$t("identical"):e.$t("random")),1),Object(o["createElementVNode"])("span",b,Object(o["toDisplayString"])("1"==F.form.type?e.$t("singleAmount"):e.$t("totalAmount")),1)])]})),value:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",f,[Object(o["createVNode"])(J,{border:!1,modelValue:F.form.amount,"onUpdate:modelValue":t[6]||(t[6]=function(e){return F.form.amount=e}),type:"number",clearable:"","input-align":"right",placeholder:e.$t("enterAmonut")},null,8,["modelValue","placeholder"]),Object(o["createElementVNode"])("span",p,Object(o["toDisplayString"])(F.currency),1)])]})),_:1}),Object(o["createElementVNode"])("span",h,Object(o["toDisplayString"])(e.$t("availableBalance"))+" "+Object(o["toDisplayString"])(e.$f.formatNumUnit(F.currencyObj.amount))+" "+Object(o["toDisplayString"])(F.currencyObj.symbol),1),Object(o["createVNode"])(G,{class:"mt_20 flex"},{title:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",j,[Object(o["createVNode"])(H,{class:"icon-num",src:n("2761")},null,8,["src"]),Object(o["createElementVNode"])("span",O,Object(o["toDisplayString"])(e.$t("quantity")),1)])]})),value:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",g,[Object(o["createVNode"])(J,{border:!1,modelValue:F.form.quantity,"onUpdate:modelValue":t[7]||(t[7]=function(e){return F.form.quantity=e}),clearable:"","input-align":"right",placeholder:e.$t("enterQuantity"),type:"digit"},null,8,["modelValue","placeholder"]),Object(o["createElementVNode"])("span",k,Object(o["toDisplayString"])(e.$t("ger")),1)])]})),_:1}),Object(o["createElementVNode"])("span",v,Object(o["toDisplayString"])(e.$t("tipMembers",{n:e.$route.query.total})),1),Object(o["createVNode"])(G,{class:"mt_20 flex",border:!1},{title:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",w,[Object(o["createElementVNode"])("span",x,Object(o["toDisplayString"])(e.$t("deadline")),1)])]})),value:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",y,[Object(o["createVNode"])(G,{border:!1,"is-link":"",onClick:t[8]||(t[8]=function(e){return F.showTime=!0}),style:{"padding-right":"0"}},{title:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(F.form.unlockDateText),1)]})),_:1}),Object(o["createVNode"])(ee,{show:F.showTime,"onUpdate:show":t[10]||(t[10]=function(e){return F.showTime=e}),position:"bottom",round:""},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(Z,{title:e.$t("settingDeadline"),columns:F.columns,"confirm-button-text":e.$t("confirm1"),"cancel-button-text":e.$t("cancel"),"default-index":0,onConfirm:P.onConfirm,onCancel:t[9]||(t[9]=function(e){return F.showTime=!1}),onChange:P.onChange},null,8,["title","columns","confirm-button-text","cancel-button-text","onConfirm","onChange"])]})),_:1},8,["show"])])]})),_:1}),Object(o["createVNode"])(J,{class:"mt_20",modelValue:F.form.remark,"onUpdate:modelValue":t[11]||(t[11]=function(e){return F.form.remark=e}),rows:"2",autosize:"",clearable:"","show-word-limit":"",maxlength:(P.language,20),type:"textarea",placeholder:e.$t("goodLuck")},null,8,["modelValue","maxlength","placeholder"]),Object(o["createElementVNode"])("span",$,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("totalAmount"))+"  ",1),Object(o["createElementVNode"])("span",N,Object(o["toDisplayString"])(e.$f.formatNumber2(P.totalAmount)),1),Object(o["createTextVNode"])("  "+Object(o["toDisplayString"])(F.currencyObj.symbol),1)]),Object(o["createElementVNode"])("div",V,[P.isWallet?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",C,[Object(o["createVNode"])(te,{class:"mt_20 width-100",type:"primary",onClick:Object(o["withModifiers"])(P.onSubmit,["stop"]),round:"",block:"",loading:P.loading,disabled:P.disabled},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("send")),1)]})),_:1},8,["onClick","loading","disabled"])])):(Object(o["openBlock"])(),Object(o["createBlock"])(te,{key:1,class:"mt_20 width-100",type:"primary",onClick:t[12]||(t[12]=Object(o["withModifiers"])((function(e){return F.showTip=!0}),["stop"])),round:"",block:""},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("send")),1)]})),_:1}))]),Object(o["createElementVNode"])("div",_,"*"+Object(o["toDisplayString"])(e.$t("tipExpire")),1)]})),_:1},8,["onSubmit"]),Object(o["createVNode"])(ce,{show:F.showTip,onClick:t[17]||(t[17]=function(e){return F.showTip=!1})},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",A,[Object(o["createElementVNode"])("div",{class:"wrapper",onClick:t[16]||(t[16]=Object(o["withModifiers"])((function(){}),["stop"]))},[Object(o["createElementVNode"])("div",S,[Object(o["createVNode"])(oe,{class:"icon font_16 color_999999",name:"cross",onClick:t[13]||(t[13]=function(e){return F.showTip=!1})}),Object(o["createElementVNode"])("span",E,Object(o["toDisplayString"])(e.$t("jump")),1),Object(o["createElementVNode"])("span",D,"*"+Object(o["toDisplayString"])(e.$t("tipSupportChain")),1)]),P.listJump.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(M,{key:0,class:"mt_20",modelValue:F.jumpUrl,"onUpdate:modelValue":t[14]||(t[14]=function(e){return F.jumpUrl=e})},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(Q,{border:!1},{default:Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(P.listJump,(function(t,r){return Object(o["openBlock"])(),Object(o["createBlock"])(G,{key:r,clickable:"",onClick:function(e){return F.jumpUrl=t.url},border:!1},{title:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",B,[Object(o["createVNode"])(H,{round:"",width:"0.72rem",height:"0.72rem","icon-size":"0.72rem","lazy-load":"","show-loading":"",class:"icon-left",src:t.image,"error-icon":n("aecc")},null,8,["src","error-icon"]),T,Object(o["createElementVNode"])("span",R,Object(o["toDisplayString"])(e.$t("jumpTo",{n:t.name})),1)])]})),"right-icon":Object(o["withCtx"])((function(){return[Object(o["createVNode"])(W,{name:t.url},null,8,["name"])]})),_:2},1032,["onClick"])})),128))]})),_:1})]})),_:1},8,["modelValue"])):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("div",U,[Object(o["createVNode"])(te,{type:"primary",onClick:Object(o["withModifiers"])(P.jump,["stop"]),disabled:""==F.jumpUrl,round:"",block:"",color:"#3F80F7"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("confirm1")),1)]})),_:1},8,["onClick","disabled"]),Object(o["createElementVNode"])("div",I,[Object(o["createVNode"])(re,{class:"font-12 color_333 mt_15",shape:"square","icon-size":"12px",modelValue:F.checkedRemember,"onUpdate:modelValue":t[15]||(t[15]=function(e){return F.checkedRemember=e})},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("remember")),1)]})),_:1},8,["modelValue"])])])])])]})),_:1},8,["show"])])}var q=n("1da1"),F=(n("96cf"),n("d3b7"),n("00b4"),n("4d63"),n("c607"),n("2c3e"),n("25f0"),n("a9e3"),n("7db0"),n("5319"),n("fb6a"),n("1276"),n("4de4"),n("365c")),P=n("c9d9"),z={name:"ChatRedCreate",data:function(){return{form:{type:"0",price:"",amount:"",quantity:"",remark:"",unlockDate:300,unlockDateText:"5分钟"},resultList:[],show:!1,showTime:!1,currency:"",currencyObj:{id:"",amount:0,chain:"",symbol:"",price:""},search:"",loadingLock:!1,loadingSend:!1,showBtn:!1,tokenAddress:"",contractAddress:"0x4972509033ff5B7CD9eEd7c3222b880A95DC66c6",loadingApprove:!1,loadingAllow:!1,isAllow:!1,showTip:!window.ethereum,jumpUrl:localStorage.getItem("rememberWallet")||"",checkedRemember:""!=localStorage.getItem("rememberWallet"),isErrQuantity:!1,isErrAmount:!1,tokenList:[],columns:[{text:"5 ".concat(this.$t("min")),value:300},{text:"10 ".concat(this.$t("min")),value:600},{text:"30 ".concat(this.$t("min")),value:1800},{text:"1 ".concat(this.$t("hour")),value:3600},{text:"12 ".concat(this.$t("hour")),value:43200},{text:"24 ".concat(this.$t("hour")),value:86400}],balanceBNB:{}}},computed:{wallet:function(){return this.$store.state.wallet},totalAmount:function(){var e=0==this.form.type?this.form.amount:this.form.amount*this.form.quantity||0;return e},loading:function(){return this.loadingLock||this.loadingSend||this.loadingApprove||this.loadingAllow},authLoading:function(){return this.loadingApprove||this.loadingAllow},listJump:function(){return[{name:"ToKen Pocket",symbol:"tokenpocket",image:n("1e4c"),url:'tpdapp://open?params={"url": "https://m.ave.ai/chat/'.concat(this.$route.params.id,'", "chain": "ethereum", "source":"ave.ai"}')},{name:"Trust Wallet",symbol:"trustwallet",image:n("3159"),url:"trust://open_url?url=https://m.ave.ai/chat/".concat(this.$route.params.id)}]},isWallet:function(){return window.ethereum},isAllowChain:function(){var e,t=(null===(e=this.$store.state.chat)||void 0===e?void 0:e.userInfo.chain)||this.$sore.getters.netId;return t&&P["a"].some((function(e){return new RegExp("".concat(t),"i").test(e)}))||!1},disabled:function(){return 0==this.currencyObj.amount||0==this.form.amount||0==this.form.quantity},language:function(){return this.$store.getters.language},groupId:function(){return this.$store.state.chat.groupId},allUserTokenList:function(){return this.$store.getters.balanceTokens||[]}},watch:{"form.type":function(){this.form.amount=""},"form.amount":function(e){if(Number(e)>Number(this.currencyObj.amount))return this.form.amount=this.currencyObj.amount,this.currencyObj.amount},"form.quantity":function(e){Number(e)>Math.min(Number(this.$route.query.total),200)&&(this.form.quantity=Math.min(Number(this.$route.query.total),200))},tokenList:function(e){this.resultList=e},tokenAddress:function(e){e&&Number(this.form.amount)>Number(this.currencyObj.amount)&&(this.form.amount=this.currencyObj.amount),e&&this.currencyObj.amount>0&&(this.isAllow=!1)},checkedRemember:function(e){e?localStorage.setItem("rememberWallet",this.jumpUrl):localStorage.removeItem("rememberWallet")},jumpUrl:function(e){this.checkedRemember&&localStorage.setItem("rememberWallet",e)},"$store.state.chat.userInfo":function(){this.init()}},mounted:function(){var e=this;this.$nextTick((function(){e.init()}))},methods:{init:function(){var e=this;return Object(q["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.state.currentAccount){t.next=9;break}return t.next=3,e.$store.dispatch("getUserTokenList");case 3:if(t.t0=t.sent,t.t0){t.next=6;break}t.t0=[];case 6:n=t.t0,e.tokenList=e.allUserTokenList,e.balanceBNB=n.find((function(e){return"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"===e.id}))||{};case 9:case"end":return t.stop()}}),t)})))()},approve:function(e,t){var n=this;return new Promise((function(o,r){n.loadingApprove=!0;var c=n.$toast.loading({message:n.$t("authorizing"),forbidClick:!0,duration:0});Object(F["k"])(e,t).then((function(e){return e.wait()})).then((function(){o(!0)})).catch((function(e){var t,o=(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===e||void 0===e?void 0:e.message)||"";n.$notify({type:"danger",message:"".concat(n.$t("authFailed"),"\n").concat(o)}),console.log(e),r(!1)})).finally((function(){c.clear(),n.loadingApprove=!1}))}))},allowance:function(e){var t=this;return new Promise((function(n,o){t.loadingAllow=!0;var r=t.$toast.loading({message:t.$t("authorizing"),forbidClick:!0,duration:0});Object(F["j"])({spender:t.contractAddress,tokenAddress:t.tokenAddress,account:t.$store.state.chat.userInfo.address||t.$store.state.currentAccount,num:e}).then((function(e){console.log("allowance",e),n(e)})).catch((function(e){var n,r=(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||(null===e||void 0===e?void 0:e.message)||"";t.$notify({type:"danger",message:"".concat(t.$t("authFailed"),"\n").concat(r)}),console.log("err==allowance",e),o(!1)})).finally((function(){t.loadingAllow=!1,r.clear()}))}))},auth:function(){var e=this;return Object(q["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=Object(q["a"])(regeneratorRuntime.mark((function t(n,o){var r,c,a,i,l,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=null===(r=e.$store.state.chat)||void 0===r?void 0:r.userInfo.chain,u=P["a"].some((function(e){return new RegExp("".concat(s),"gi").test(e)})),u){t.next=5;break}return e.$toast(e.$t("tipSupportChain")),t.abrupt("return");case 5:if(""!=(null===(c=e.$store.state.chat)||void 0===c?void 0:c.userInfo.address)||e.$store.state.currentAccount!=(null===(a=e.$store.state.chat)||void 0===a?void 0:a.userInfo.address)){t.next=9;break}return e.$router.replace("/chat/".concat(e.$route.params.id)),e.$toast.loading({duration:3e3,forbidClick:!0,message:e.$t("tipLoginAgain")}),t.abrupt("return");case 9:if(e.$store.getters.netId==(null===(i=e.$store.state.chat)||void 0===i?void 0:i.userInfo.chain)||""==(null===(l=e.$store.state.chat)||void 0===l?void 0:l.userInfo.chain)){t.next=12;break}return e.$toast(e.$t("tipSwitchChain",{chain:s})),t.abrupt("return");case 12:if("importAddress"!=e.$store.state.wallet||""!=e.$store.state.provider||!window.ethereum){t.next=15;break}return e.$dialog.alert({message:e.$t("connectWalletAgain"),confirmButtonText:e.$t("iKnown"),confirmButtonColor:"#3F80F7"}),t.abrupt("return");case 15:if(!(window.ethereum&&(e.$store.state.chat.userInfo||e.$tore.state.currentAccount)&&e.currencyObj.amount>0)){t.next=28;break}return t.next=18,e.allowance();case 18:if(e.isAllow=t.sent,e.isAllow){t.next=28;break}return t.next=22,e.approve(e.contractAddress,e.tokenAddress);case 22:if(e.isApprove=t.sent,t.t0=e.isApprove,!t.t0){t.next=28;break}return t.next=27,e.allowance();case 27:e.isAllow=t.sent;case 28:e.isAllow?n(!0):o(!1);case 29:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})))()},onSubmit:function(){var e=this;return Object(q["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=/^[0-9]*/,""!=e.form.amount&&""!=e.form.quantity){t.next=5;break}e.$toast(e.$t("tipSendNotEmpty")),t.next=20;break;case 5:if(n.test(Number(e.form.amount))&&n.test(Number(e.form.quantity))){t.next=9;break}e.$toast(e.$t("tipSendIsNumber")),t.next=20;break;case 9:if(!(Number(e.form.quantity)>Number(e.$route.query.total))){t.next=13;break}e.$toast(e.$t("tipSendNum")),t.next=20;break;case 13:if(!(Number(e.totalAmount)>Number(e.currencyObj.amount))){t.next=17;break}e.$toast(e.$t("tipSendBalance")),t.next=20;break;case 17:return t.next=19,e.auth();case 19:e.isAllow&&e.lock();case 20:case"end":return t.stop()}}),t)})))()},lock:function(){var e=this,t={_owner:this.$store.state.currentAccount,token:this.tokenAddress,amount:Number(this.totalAmount),unlockDate:this.form.unlockDate,quantity:Number(this.form.quantity),kind:this.form.type,balanceBNB:this.balanceBNB};this.loadingLock=!0;var n=this.$toast.loading({message:this.$t("createContract"),forbidClick:!0,duration:0});Object(F["lc"])(this.contractAddress,t).then((function(e){return e.wait()})).then(function(){var n=Object(q["a"])(regeneratorRuntime.mark((function n(o){var r,c,a,i,l,s,u,d,m;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:c=null===o||void 0===o?void 0:o.events,a={},i=c.length-1;case 3:if(!(i>=0)){n.next=11;break}if(l=c[i].topics.some((function(e){return"0x694af1cc8727cdd0afbdd53d9b87b69248bd490224e9dd090e788546506e076f"===e})),c[i].address!=e.contractAddress||!l){n.next=8;break}return a=c[i],n.abrupt("break",11);case 8:i--,n.next=3;break;case 11:return s=a["data"].slice(-128,-64),n.next=14,Object(F["Y"])(e.tokenAddress);case 14:return u=n.sent,n.next=17,Object(F["H"])(e.tokenAddress,"0x"+s);case 17:d=n.sent,m={group_id:e.groupId,contract_address:e.tokenAddress,contract_chain:null===(r=e.groupId)||void 0===r?void 0:r.split("-")[1],red_packet_id:a["topics"][1],tx:o.transactionHash,type:Number(t.kind),total_amount:Number(d),single_amount:Number(d)/t.quantity,count:t.quantity,end_time:e.form.unlockDate,remark:e.form.remark||e.$t("goodLuck"),symbol:e.currencyObj.symbol,contract_decimal:u},e.sendRedPacket(m);case 20:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(t){if(-1===t)e.$notify({type:"danger",message:"Insufficient gas"});else{var n,o=(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||(null===t||void 0===t?void 0:t.message)||"";e.$notify({type:"danger",message:"".concat(e.$t("createContractFailed"),"\n ").concat(o)})}console.log("err==lock",t)})).finally((function(){e.loadingLock=!1,n.clear()}))},sendRedPacket:function(e){var t=this;this.loadingSend=!0;var n=this.$toast.loading({message:this.$t("creatingRedPacket"),forbidClick:!0,duration:0});Object(F["Fc"])(e).then((function(){t.back(),t.$store.dispatch("getUnreceivedredpacket")})).catch((function(e){t.$dialog.alert({title:t.$t("creatingRedPacketFailed"),message:"".concat(e,",").concat(t.$t("tipRefund")),confirmButtonText:t.$t("iKnown"),confirmButtonColor:"#3F80F7"}),console.log("err==send",e)})).finally((function(){t.loadingSend=!1,n.clear()}))},onSearch:function(e){var t=new RegExp(e,"i");this.resultList=""!=e?this.tokenList.filter((function(e){return t.test(e.symbol)||t.test(e.id)})):this.tokenList},jump:function(){var e;this.showTip=!1,null===(e=this.$f.androidGlobal())||void 0===e||e.openBrowser(this.jumpUrl)},back:function(){var e,t,n;null!==(e=this.$f.androidGlobal())&&void 0!==e&&e.back?null===(t=this.$f.androidGlobal())||void 0===t||null===(n=t.back)||void 0===n||n.call(t):window.history.state.back?this.$f.goBack():this.$router.replace("/chat/".concat(this.$route.params.id))},onConfirm:function(e){this.showTime=!1,console.log("confirm",e)},onChange:function(e){this.form.unlockDate=e.value,this.form.unlockDateText=e.text}}},W=(n("f08d"),n("6b0d")),M=n.n(W);const J=M()(z,[["render",L],["__scopeId","data-v-5a43125f"]]);t["default"]=J},2761:function(e,t,n){e.exports=n.p+"static/img/num.3c34d786.svg"},3159:function(e,t,n){e.exports=n.p+"static/img/trustwallet.f95f80ba.png"},7745:function(e,t,n){},f08d:function(e,t,n){"use strict";n("7745")}}]);