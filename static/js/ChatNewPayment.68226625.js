(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ChatNewPayment"],{"664b":function(t,e,n){},"9f9c":function(t,e,n){"use strict";n.r(e);n("fb6a");var o=n("7a23"),c={class:"burn-container"},a={class:"section-1"},r={class:"top"},s={key:0,class:"font-12 block color-999 mt_10"},i={class:"iconfont icon-copy font-12"},l={class:"section-3"},d={class:"icon-svg","aria-hidden":"true"},u=["xlink:href"],h={class:"section-6"},b={class:"submit-bar van-safe-area-bottom van-hairline--top"};function f(t,e,n,f,p,g){var m,O,j,k=Object(o["resolveComponent"])("van-nav-bar"),v=Object(o["resolveComponent"])("van-image"),$=Object(o["resolveComponent"])("van-cell"),C=Object(o["resolveComponent"])("van-button"),y=Object(o["resolveComponent"])("router-link"),_=Object(o["resolveDirective"])("copy");return Object(o["openBlock"])(),Object(o["createElementBlock"])("section",c,[Object(o["createVNode"])(k,{"left-text":"","left-arrow":"",onClickLeft:e[0]||(e[0]=function(e){return t.$f.goBack()}),fixed:"",placeholder:"","safe-area-inset-top":"","z-index":"2",title:t.$t("operationPay")},null,8,["title"]),Object(o["createElementVNode"])("div",a,[Object(o["createElementVNode"])("div",r,[Object(o["createVNode"])(v,{class:"icon",width:"0.48rem",height:"0.48rem",round:"","lazy-load":"",src:"".concat(t.$store.state.s3BaseUrl,"token_icon/oec/0x382bb369d343125bfb2117af9c149795c6c65c50.png")},null,8,["src"]),Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(g.amount)+"USDT",1)]),g.tokenAddress?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",s,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.$t("contractAddress"))+" "+Object(o["toDisplayString"])((null===(m=g.tokenAddress)||void 0===m?void 0:m.slice(0,4))+"..."+(null===(O=g.tokenAddress)||void 0===O?void 0:O.slice(-4)))+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("i",i,null,512),[[_,g.tokenAddress]])])):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",l,[Object(o["createVNode"])($,{title:"支付方式",center:""},{"right-icon":Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(),Object(o["createElementBlock"])("svg",d,[Object(o["createElementVNode"])("use",{"xlink:href":"#icon-".concat(g.currentChain.chain)},null,8,u)])),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(g.currentChain.title),1)]})),_:1})]),Object(o["createElementVNode"])("div",h,Object(o["toDisplayString"])(t.$t("chainTransferNewTips")),1),Object(o["createElementVNode"])("div",b,[""!==t.$store.state.wallet&&"importAddress"!==t.$store.state.wallet?(Object(o["openBlock"])(),Object(o["createBlock"])(C,{key:0,block:"",round:"",loading:g.loading,type:"primary",onClick:Object(o["withModifiers"])(g.onSubmit,["stop"])},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.$t("transfer")),1)]})),_:1},8,["loading","onClick"])):"importAddress"==t.$store.state.wallet?(Object(o["openBlock"])(),Object(o["createBlock"])(C,{key:1,block:"",round:"",loading:g.loading,type:"primary"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.$t("importAddress")),1)]})),_:1},8,["loading"])):(Object(o["openBlock"])(),Object(o["createBlock"])(C,{key:2,block:"",round:"",loading:g.loading,type:"primary"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.$t("connectWallet")),1)]})),_:1},8,["loading"])),"burn"==t.$route.params.type?(Object(o["openBlock"])(),Object(o["createBlock"])(y,{key:3,to:{name:"ChatBurn",params:{id:g.groupId,illegalId:t.$route.params.illegalId},query:{admin:"admin"===(null===(j=t.$route.query)||void 0===j?void 0:j.admin)?"admin":""}},class:"font-14"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.$t("manualTransfer")),1)]})),_:1},8,["to"])):(Object(o["openBlock"])(),Object(o["createBlock"])(y,{key:4,to:{name:"ChatPayment",params:{id:g.groupId}},class:"font-14"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.$t("manualTransfer")),1)]})),_:1},8,["to"]))])])}n("b0c0"),n("d3b7");var p=n("365c"),g=n("fa7d"),m={name:"ChatNewPayment",data:function(){return{loadingTransfer:!1,loadingCheck:!1,tx:"",loadingAllow:!1}},computed:{groupId:function(){return this.$store.state.chat.groupId},lang:function(){return this.$store.getters.language},fromAddress:function(){return this.$store.state.currentAccount},toAddress:function(){var t;return(null===(t=this.$store.state.chat.chatConfig)||void 0===t?void 0:t.ave_chat_usdt_to_address)||""},tokenAddress:function(){var t,e;return"oec"===this.$store.getters.netId?null===(t=this.$store.state.chat.chatConfig)||void 0===t?void 0:t.ave_chat_usdt_address_oec:"bsc"===this.$store.getters.netId?null===(e=this.$store.state.chat.chatConfig)||void 0===e?void 0:e.ave_chat_usdt_address_bsc:""},amount:function(){var t,e;return"burn"==this.$route.params.type?(null===(t=this.$store.state.chat.chatConfig)||void 0===t?void 0:t.ave_chat_usdt_count)||"":(null===(e=this.$store.state.chat.chatConfig)||void 0===e?void 0:e.ave_chat_usdt_count_register)||""},currentChain:function(){return"oec"===this.$store.getters.netId?{title:"OKC",chainId:66,chain:"oec"}:"bsc"===this.$store.getters.netId?{title:"BSC",chainId:56,chain:"bsc"}:{}},loading:function(){return this.loadingTransfer||this.loadingCheck},allUserTokenList:function(){return this.$store.getters.balanceTokens||[]}},watch:{"$store.state.currentAccount":function(t){t&&"ChatNewPayment"===this.$route.name&&t!==localStorage.currentAccount&&(this.$router.push("/chat/".concat(this.groupId)),Object(g["b"])())}},activated:function(){this.$store.dispatch("getChatInfo"),this.$store.dispatch("getUserTokenList")},methods:{onSubmit:function(){var t=this,e={address_to:this.toAddress,num:this.amount,tokenAddress:this.tokenAddress};this.loadingTransfer=!0;var n=!1;if(this.allUserTokenList.length>0&&(n=this.allUserTokenList.some((function(e){if("USDT"===e.symbol&&e.amount>t.amount)return!0}))),!n)return this.loadingTransfer=!1,void this.$notify({type:"danger",message:this.$t("chainTransferNewTipsInsufficient")});Object(p["Nc"])(e).then((function(t){return t.wait()})).then((function(e){t.$toast.success(t.$t("transferSuccess")),t.tx=e.transactionHash,t.tx?"burn"==t.$route.params.type?t.checkConsumed():t.checkConsumedUser():t.$notify({type:"danger",message:t.$t("fail")})})).catch((function(e){t.$f.handleError(e)})).finally((function(e){console.log(e),t.loadingTransfer=!1}))},checkConsumedUser:function(){var t=this,e={user_address:this.fromAddress,chain:this.currentChain.chain,tx:this.tx};this.loadingCheck=!0,Object(p["x"])(e).then((function(e){e&&(t.tx="",t.groupId?(t.$router.push("/chat/".concat(t.groupId)),Object(g["b"])()):t.$router.push("/myChat"))})).catch((function(e){t.$toast.fail(e)})).finally((function(e){console.log(e),t.loadingCheck=!1}))},checkConsumed:function(){var t=this,e={consumed_Type:this.$route.params.illegalId?2:1,group_id:this.groupId,chain:this.currentChain.chain,tx:this.tx};this.loadingCheck=!0,Object(p["w"])(e).then((function(e){e&&(t.$route.params.illegalId?t.$store.dispatch("getChatGroupSettings").then((function(){t.$toast({message:t.$t("dissolutionSuccessful"),position:"top"}),t.loadingCheck=!1})):(t.$store.dispatch("getChatInfo").then((function(){t.$toast({message:t.$t("becomeAnAdmin"),position:"top"})})),t.loadingCheck=!1))})).catch((function(e){t.loading=!1,t.$toast({message:e,position:"top"})}))}}},O=(n("e4e3"),n("6b0d")),j=n.n(O);const k=j()(m,[["render",f],["__scopeId","data-v-62cfd842"]]);e["default"]=k},e4e3:function(t,e,n){"use strict";n("664b")}}]);